dist: xenial
sudo: required
services:
- postgresql
- xvfb
env:
- DJANGO_SETTINGS_MODULE="decide.settings"
addons:
  postgresql: '9.4'
before_install:
- sudo apt-get update
- sudo apt-get install dbus-x11
- export DISPLAY=:99.0
- export CHROME_BIN=/usr/bin/google-chrome
- sudo apt-get install -y libappindicator1 fonts-liberation
- wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
- sudo dpkg -i google-chrome*.deb
- wget https://chromedriver.storage.googleapis.com/2.38/chromedriver_linux64.zip
- unzip chromedriver_linux64.zip
- sudo cp chromedriver /usr/bin
before_script:
- psql -U postgres -c "create user decide password 'decide'"
- psql -U postgres -c "create database test_decide owner decide"
- psql -U postgres -c "ALTER USER decide CREATEDB"
language: python
python:
- '3.6'
install:
- pip install -r requirements.txt
script:
- cd decide
- cp travis_local_settings.py local_settings.py
- python ./manage.py test --keepdb
deploy:
  provider: heroku
  app: decide-dialga-auth
  strategy: git
  api_key:
    secure: hJRoV5t1IbwDY7QsoAkzHl4nXjlvkfzDPjwSIZzcWqqoJEPXu6WdEjls0pVr862ca7M3O/3bgx9hQoDRgJ/CPYuNXvMdDVEva9u3xF96AMlHaHes/dFdZ63SQ3pZR5kCVsGhjLCcHAyK6PTistoWH6U6gUj1LKXchWzludoTszJqlKFM3SoNYKLm5xJSIC2TOxXQ1SPDIpPl94Gee/2akIJdBe2hTODCafDsqHSobFIIFr4YnuCqq3waN8DNmrCHgWimhhwE/DTBh6RXX2cuXfoJDup8cH9Rc1tHH+N3EeO/9KqRJBEOh3a5CjdfduNYfElDu1NDVUigXoLa8PtcACtOrqf4ecvOhNDDDQkhNUlZXTLhtbk5988c0fb6eFXdjgEDE+DBZdqst/UEiK+9spWwWd4nabXhGbk1MBRIIdEjc0qpMm6oZ3Y0EutP1Prr/N9jVrCxCdVoHtDJLbYRHQL7IHxCPO9AT7HJERfFxU9upowSmsi8NM99MhDX/OHhM2YhB6KqmA4kUkMHVqYnL/qk52KOpVCsqYFc0omDdemVYsghOHcHB7NQnIAw9J97vO8JlvDH45b9Ve6K/ri4bDGdBiqazeQkDN8eSD3WAwFOM8XgPYkvYFAml71Xpx19ZvRWpp18C1ECp2KLUG6xF1rG1KiAMVcKnnXwyPb78B4=
